---
layout: post
title: "卷积神经网络"
date: 2020-09-14 19:36:26
draft: false
description: "卷积、图像去噪、边缘提取、纹理表示、卷积神经网络"
tags: 
- CV
- AI
categories: 
- CV
mathjax: true
---

## 卷积与图像去噪

### 图像去噪与卷积

噪声：一个点与周围点差别比较大

去噪简单思想：周围的点加权平均一下

卷积核：即权值集合

卷积定义：令$F$为图像，$H$为卷积核，$F$与$H$的卷积记为$R=F * H$。

$$
R_{ij} = \sum_{u,v} H_{i-u,j-v} F_{u,v}
$$

使用$H$将$F$卷积到域$R$

先将卷积核进行$108°$翻转，再去图像上滤波。如果不翻转则是进行相关操作。

卷积性质：

叠加性：$filter(f_1 + f_2) = filter(f_1) + filter(f_2)$

平移不变性：$filter( shift(f) ) = shift( filter(f) )$

交换律、结合律、分配律和标量乘。

边界填充：图像边界的卷积需要进行填充。

卷积操作后的图像要小于输入时图像，通过边界填充，我们可以实现卷积前后图像的尺寸不变。最常用的边界填充就是常数填充。

原图 - 平滑模板 = 边缘图
原图 + 边缘图 = 锐化操作

### 高斯卷积核

平均卷积核卷积后的图像产生了一些水平和竖直方向的条状**振铃**。

解决振铃的方法：根据领域像素与中心得远近程度分配权重，离中心近的权重大。

高斯核：

$$
G_{\sigma} = \frac{1}{2\pi \sigma^2} e^{ - \frac{(x^2 + y^2)}{2 \sigma^2}}
$$

生成步骤：
1. 确定卷积核的尺寸，比如$5 * 5$；
2. 设置高斯函数的标准差，比如$\sigma = 1$；
3. 计算卷积核各个位置权重值；
4. 对权重值进行归一化。

卷积核参数总结：

大方差或者大尺寸卷积核平滑能力强；  
经验法则：将卷积核的半窗宽度设置为$3\sigma$，最终卷积模板尺寸为$2 * 3 \sigma + 1$。$3\sigma$以外的值接近于$0$，无意义。

高斯卷积核的特性

去除图像中的"高频"成分(低通滤波器)

两个高斯卷积核卷积后得到的还是高斯卷积核  
使用多次小方差卷积核连续卷积，可以得到与大方差卷积核相同的结果  
使用标准差为$\sigma$的高斯核进行两次卷积与使用标准差$\sigma \sqrt 2$的高斯核进行一次卷积相同。

可分离  
可分解为两个一维高斯的乘积，可极大的减少计算量。

卷积操作运算量

用尺寸为$m * m$的卷积核卷积一个尺寸为$n * n$的图像，其计算复杂度是多少？

直接计算是$O(m^2n^2)$，改成两个一维高斯核卷积，复杂度为$O(mn^2)$

### 图像噪声与中值滤波器

#### 噪声

椒盐噪声：黑色像素和闹色像素随机出现。

脉冲噪声：白色像素随机出现。

高斯噪声：噪声强度变化服从高斯分布。

$$
\begin{align}
&高斯噪声： \hat f (x, y) = f(x, y) + \eta (x, y) \\\\\\
& \eta (x, y) \text{~} N(\mu,\sigma), 通常\mu = 0, \sigma很小
\end{align}
$$

对于椒盐噪声和脉冲噪声，高斯核卷积无法完全去噪。需要使用中值滤波器。

中值滤波器使用的卷积核无权重，对范围内的数值进行排序，选择权值中间的值替换。

![中值滤波器](/images/CV/ConvolutionalNeuralNetwork_1.png)

高斯卷积核是线性操作，中值滤波器不是线性操作。
